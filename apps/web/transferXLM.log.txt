üì± Contract devices query successful
üì± Devices registered in contract: 1
   Device: {
  device_id: '308fd9b114f845a55e93eb54ceb7f5143ab44cf900d2e0d86dccd9d2975a4d36',
  public_key: '04767dfffe3a2488caa7bec4c1b1d05eabe8a4170114374a7f8c314acab8fb728da992d498197e172dc7703981f21dac5db1d18b699b82954febd4fd37356fdcf1'
}
‚úÖ Loaded pre-assembled transaction from prepare endpoint
üìù Auth entries count: 1
üîç Converting COSE public key to uncompressed format...
   Input length: 77 bytes
üîç COSE key parameters: { kty: 2, alg: -7, crv: 1, xCoordLength: 32, yCoordLength: 32 }
‚úÖ Converted to uncompressed secp256r1 format
   Output length: 65 bytes
   Hex: 04767dfffe3a2488caa7bec4c1b1d05eabe8a4170114374a7f8c314acab8fb728da992d498197e172dc7703981f21dac5db1d18b699b82954febd4fd37356fdcf1
üîë Computed device_id from COSE public key: {
  coseLength: 104,
  uncompressedLength: 65,
  deviceId: '308fd9b114f845a55e93eb54ceb7f5143ab44cf900d2e0d86dccd9d2975a4d36'
}
üîè WebAuthn Signature Details:
   Signature (base64): 1yrPW+LzmoLCl5SPJEOowQDRSOA8yu4X+01VExZA5ldEqIGrCOjoy9JZ5qK8HuS6D8yhwfYIL+w9ncjYc685LA==
   Authenticator Data (base64): SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MZAAAAAA==
   Client Data (object): {
  type: 'webauthn.get',
  challenge: 'VRwaGtpxuGmvFufIZlevudzisDUjW0RL_bVvWSsB5GA',
  origin: 'http://localhost:3000',
  crossOrigin: false
}
   WebAuthn Payload (base64): SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MZAAAAAOIaPEFzc/o2ayPpxQ7tmB1y+pq4CC5LNFmB+8+VF2+w
   WebAuthn Payload Hash (hex): ce09bfbaf01de682bd8f4f10ed5dcebe4f1568072197bcfcc71519993607f4ce
   Challenge (utf8): VRwaGtpxuGmvFufIZlevudzisDUjW0RL_bVvWSsB5GA
   Challenge Bytes (hex): 551c1a1ada71b869af16e7c86657afb9dce2b035235b444bfdb56f592b01e460
üîí Checking rate limit for address: CBCEQWKXVA42G7NFPSH4L32UAI47674MFAXLRFQMNJYWF5WCFBCNWQDZ
 GET /demo/smart-wallet 200 in 400ms
‚ö†Ô∏è Redis rate limit check failed, using in-memory: TypeError: fetch failed
    at async SignatureRateLimiter.checkRedisLimit (../../packages/lib/src/stellar/rate-limiter.ts:111:18)
    at async SignatureRateLimiter.checkLimit (../../packages/lib/src/stellar/rate-limiter.ts:57:11)
    at async StellarPasskeyService.verifyPasskeySignature (../../packages/lib/src/stellar/stellar-passkey.service.ts:450:27)
    at async POST (app/api/stellar/transfer/submit/route.ts:155:31)
  109 |                 pipeline.expire(redisKey, Math.ceil(this.config.windowMs / 1000))
  110 |
> 111 |                 const results = await pipeline.exec()
      |                                ^
  112 |
  113 |                 if (!results) {
  114 |                         throw new Error('Redis pipeline failed') {
  [cause]: [Error: getaddrinfo ENOTFOUND prime-pipefish-17004.upstash.io] {
    errno: -3008,
    code: 'ENOTFOUND',
    syscall: 'getaddrinfo',
    hostname: 'prime-pipefish-17004.upstash.io'
  }
}
‚úÖ Rate limit check passed: { remaining: 4, resetAt: '2025-11-28T17:58:54.616Z' }
üîç Verifying passkey signature for address: CBCEQWKXVA42G7NFPSH4L32UAI47674MFAXLRFQMNJYWF5WCFBCNWQDZ
üìù Signature data: {
  authenticatorData: 'SZYN5YgOjGh0NBcPZHZgW4_krrmihjLHmVzzuoMdl2MZAAAAAA',
  clientDataJSON: 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiVlJ3YUd0cHh1R212RnVmSVpsZXZ1ZHppc0RValcwUkxfYlZ2V1NzQjVHQSIsIm9yaWdpbiI6Imh0dHA6Ly9sb2NhbGhvc3Q6MzAwMCIsImNyb3NzT3JpZ2luIjpmYWxzZX0',
  signature: 'MEYCIQDXKs9b4vOagsKXlI8kQ6jBANFI4DzK7hf7TVUTFkDmVwIhALtXflP3Fxc1LaYZXUPhG0WtGljrsQ9umLYcAeqIs-wl',
  userHandle: 'eabeYpGOwOMisAqvVy30zy4fAs9jgIVe8TD8Mr-5pRk'
}
‚ùå Challenge mismatch: {
  expected: '266e9700f22a1b7b2c4349ac06ceb915e0f8592d76810d57ae57419cb34bfa63',
  received: 'VRwaGtpxuGmvFufIZlevudzisDUjW0RL_bVvWSsB5GA'
}
üîê Contract will verify signature { verificationResults: false }
‚úÖ WebAuthn signature added to auth entry
üìù Transaction ready for submission
‚úçÔ∏è  Signing transaction with funding account...
   Hash: bc0876728f77bd248cd5412193db95205b12d50b20c61222dc7a726861a512a1
üöÄ Submitting to Stellar network...
Hash: bc0876728f77bd248cd5412193db95205b12d50b20c61222dc7a726861a512a1
üîó https://stellar.expert/explorer/testnet/tx/bc0876728f77bd248cd5412193db95205b12d50b20c61222dc7a726861a512a1
‚úÖ Transaction submitted successfully
 POST /api/stellar/transfer/submit 200 in 6192ms
üìä Fetching balances for: CBCEQWKXVA42G7NFPSH4L32UAI47674MFAXLRFQMNJYWF5WCFBCNWQDZ
üîç Querying XLM SAC: CDLZFC3SYJYDZT7K67VZ75HPJVIEUVNIXF47ZG2FB2RMQQVU2HHGCYSC
   For address: CBCEQWKXVA42G7NFPSH4L32UAI47674MFAXLRFQMNJYWF5WCFBCNWQDZ
‚úÖ Balance retrieved: 300000000 stroops
 GET /api/stellar/balances/CBCEQWKXVA42G7NFPSH4L32UAI47674MFAXLRFQMNJYWF5WCFBCNWQDZ 200 in 208ms
‚úÖ Connected to Upstash Redis for rate limiting